webpackJsonp([4],{"/eR5":function(e,n,t){"use strict";function r(e){function n(){return i}function r(n){var t=o(e,n);return i.push(t),t}e.inputs=t.i(a.a)();var i=[];return function(){var e=c.a.getQS().get("i0");if(e){var n=r(0);n.link=e,n.updateBinding(!0)}}(),{getInputs:n,addInput:r}}function o(e,n){function r(e){a&&(clearTimeout(a),a=null),e?o():a=setTimeout(o,300)}function o(){u.error=null,a=null;var r=t.i(i.a)(e,u.link,{done:function(){c.a.getQS().set("i"+n,u.link)},error:function(e){u.error=e}});e.inputs.bindInput(0,r)}var a=null,u={link:"",error:null,name:"input"+n,updateBinding:r};return u}n.a=r;var a=t("n67P"),i=(t("p2DF"),t("I6d+")),c=t("NEgR")},"3xg8":function(e,n,t){"use strict";function r(e){function n(n){p.setCustomVectorField(n);var t=p.getFragmentShader(),r=p.getVertexShader(),o=a.a.createProgram(_,r,t);h&&h.unload(),h=o,e.colorMode===c.a.VELOCITY&&w.requestSpeedUpdate()}function r(n,r){g=e.particleStateResolution;var o=[{name:"x",particleState:n},{name:"y",particleState:r}];y&&y.dispose(),y=t.i(s.a)(_,o,g),m&&m.dispose(),m=t.i(s.a)(_,o,g),w.updateParticlesCount()}function i(n){e.colorMode===c.a.VELOCITY&&w.setColorMinMax(n),y.bindTextures(_,n)}function l(){var n=h;_.useProgram(n.program),a.a.bindAttribute(_,e.quadBuffer,n.a_pos,2),e.inputs.updateBindings(n),e.audioTexture&&(a.a.bindTexture(_,e.audioTexture,5),_.uniform1i(n.u_audio,5)),y.bindTextures(_,n),_.uniform1f(n.u_rand_seed,e.frameSeed),_.uniform1f(n.u_h,e.integrationTimeStep),_.uniform1f(n.frame,e.frame);var t=e.cursor;_.uniform4f(n.cursor,t.clickX,t.clickY,t.hoverX,t.hoverY);var r=e.bbox;_.uniform2f(n.u_min,r.minX,r.minY),_.uniform2f(n.u_max,r.maxX,r.maxY),_.uniform1f(n.u_drop_rate,e.dropProbability);for(var o=0;o<m.length;++o){var i=m.get(o);_.uniform1i(n.u_out_coordinate,o),a.a.bindFramebuffer(_,e.framebuffer,i.texture),_.viewport(0,0,g,g),_.drawArrays(_.TRIANGLES,0,6)}e.colorMode===c.a.VELOCITY&&w.updateParticlesPositions(n),b&&(x(n),b=null);var u=y;y=m,m=u}function v(e){b=e}function x(n){var r=[{name:"x",particleState:b.x},{name:"y",particleState:b.y}],i=b.resolution,c=i*i,u=t.i(s.a)(_,r,i),l=t.i(s.a)(_,r,i);u.bindTextures(_,n);var v=l.get(0);_.uniform1i(n.u_out_coordinate,6),a.a.bindFramebuffer(_,e.framebuffer,v.texture),_.viewport(0,0,i,i),_.drawArrays(_.TRIANGLES,0,6);var p=new Uint8Array(4*c);_.readPixels(0,0,i,i,_.RGBA,_.UNSIGNED_BYTE,p),_.uniform1i(n.u_out_coordinate,7),v=l.get(1),a.a.bindFramebuffer(_,e.framebuffer,v.texture),_.viewport(0,0,i,i),_.drawArrays(_.TRIANGLES,0,6);var x=new Uint8Array(4*c);_.readPixels(0,0,i,i,_.RGBA,_.UNSIGNED_BYTE,x),l.dispose(),u.dispose();for(var y=t.i(d.a)(),m=t.i(d.a)(),g=new Float32Array(c),h=new Float32Array(c),w=0;w<x.length;w+=4){var T=w/4,E=o(p,w),P=o(x,w);g[T]=E,h[T]=P,y.add(E),m.add(P)}var M={xStats:y,yStats:m,decoded_velocity_x:g,decoded_velocity_y:h,resolution:i};f.a.fire("vector-line-ready",M)}var y,m,g,h,b,_=e.gl,w=t.i(u.a)(e);return f.a.on("vector-lines-request",v),{updateCode:n,updateParticlesPositions:l,updateParticlesCount:r,prepareToDraw:i}}function o(e,n){return t.i(l.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var a=t("Ddjs"),i=t("Qv35"),c=t("6c6E"),u=t("gIFv"),s=t("pXNl"),d=t("V39N"),l=t("FaU1"),v=t("eBcr"),f=t.n(v),p=new i.a},"4KA4":function(e,n,t){"use strict";var r=t("Zrlr"),o=t.n(r),a=t("wxAW"),i=t.n(a),c=function(){function e(){o()(this,e)}return i()(e,[{key:"getDefines",value:function(){return""}},{key:"getFunctions",value:function(){return""}},{key:"getMainBody",value:function(){return""}}]),e}();n.a=c},"6c6E":function(e,n,t){"use strict";n.a={UNIFORM:1,VELOCITY:2,ANGLE:3,CUSTOM:4}},"7QEO":function(e,n,t){"use strict";n.a=[{name:"Secret door",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.15344999999999986,cy:-.1291,w:7.4611,h:7.4611,code:"// p.x and p.y are current coordinates\n  // v.x and v.y is a velocity at point p\n  vec2 get_velocity(vec2 p) {\n    vec2 v = vec2(0., 0.);\n\n    // change this to get a new vector field\n    v.x = p.y*p.y ;\n    v.y = -p.x*p.x *.05;\n\n    return v;\n  }"},{name:"Miserables graph with edges",timeStep:-.001,fadeOut:.998,dropProbability:.008,colorMode:2,cx:.467,cy:1.5294,w:.9368,h:.9368,showBindings:1,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/bafb63d01e0ab37c1f9b51522a5ec4fbc19bc4f1/edges.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  if (length(v) < 0.1) v = vec2(0.);\n  return (v);\n}",particleCount:4e4},{name:"Roads",timeStep:.001,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.478,cy:.2636,w:.9922,h:.9922,showBindings:0,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/cd7d82c5a235f50f5655ac94aa9077709731adde/binary_tree.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  return (v);\n}",particleCount:4e4},{name:"Four counterclockwise cogs pushing particles clockwise :)",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.7887499999999994,cy:-.5769500000000001,w:16.3759,h:16.3759,code:"vec2 field(vec2 p) {\n  float d = length(p);\n  return vec2(-p.y, p.x) * exp(-d*d*0.1);\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v = field(p + vec2(-5., 0.)) +\n    field(p + vec2(-2.5, 2.5)) +\n    field(p + vec2(0., 0.)) +\n    field(p + vec2(-2.5, -2.5));\n  return v;\n}"},{name:"Waveshaping [interactive]",cx:0,cy:-.060899999999999954,w:12,h:12,timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,code:"float f(float x) {\n  bool supportsHover = length(cursor.zw) > 0.01;\n  vec2 c = supportsHover ? cursor.zw : cursor.xy;\n  float f1 = sin(x);\n  float f2 = sin(2.*x);\n  float f3 = sin(3.*x);\n  float f4 = sin(4.*x);\n  float f5 = sin(5.*x);\n  return f1 +\n    f2*c.x/4. +\n    f3*c.y/6. +\n    f4*c.x/8. +\n    f5*c.y/10.;\n}\n\nfloat df(float x) {\n  float h = 0.001;\n  return (f(x+h)-f(x-h))/(2.*h);\n}\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float fx = f(p.x);\n  float d = abs(p.y-fx);\n  float dfx = df(p.x);\n  vec2 toOrigin = -p/(20.*length(p));\n  vec2 toF = 0.1*vec2(0.,fx-p.y);\n  v = d < 0.1 ? vec2(1.,dfx) : toF;\n  return v;\n}",particleCount:5e4},{name:"Hex plane [interactive]",timeStep:.01,fadeOut:.99,dropProbability:.99,colorMode:3,cx:0,cy:0,w:8.5398,h:8.5398,code:"vec2 nearest(vec2 p) {\n// Charles Chambers black hex magic\nfloat temp = floor(p.x + sqrt(3.) * p.y + 1.);\nfloat q = floor((floor(2.*p.x+1.) + temp) / 3.);\nfloat r = floor((temp + floor(-p.x + sqrt(3.) * p.y + 1.))/3.);\nreturn vec2(q-p.y/2.,r-p.y/8.);\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  float f = frame/1000.;\n  float z = (3.-p.y)/(6.+cursor.zw.y*2.);\n  float a = cursor.zw.x;\n  vec2 r = vec2(cos(a)*p.x - sin(a)*p.y,sin(a)*p.x+cos(a)*p.y);\n  vec2 t = vec2(r.x / z, r.y / z);\n  vec2 n = nearest(t);\n  v.x = t.x-n.x;\n  v.y = t.y-n.y;\n  return v;\n}",particleCount:5e5},{name:"Rain",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"bool isUnshadowed(vec2 p) {\n  bool upper = length(p) > 1.0 && p.y > 0.0;\n  bool lower = length(p) > 1.0 && p.y < 0.0 && abs(p.x) > 1.0;\n  return upper || lower;\n}\n\nvec2 unshadowedV(vec2 p) {\n  return vec2(0.0,-3.0+p.y);\n}\n\nbool isSpray(vec2 p) {\n  return length(p) > 1.0 && abs(p.x) < 1.0;\n}\n\nvec2 sprayV(vec2 p) {\n  float vy = -1.0+p.y;\n  float vx = p.x > 0.0 ? (1.0-p.x)/vy : (-1.0-p.x)/vy;\n  return vec2(vx,vy);\n}\n\nbool isCircle(vec2 p) {\n  return length(p) > 1.0 && length(p) < 1.05;\n}\n\nvec2 circleV(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v.x = sign(p.x)* p.y;\n  v.y = -abs(p.x);\n  return v;\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  v = isCircle(p) ? circleV(p) :\n      isUnshadowed(p) ? unshadowedV(p) :\n      isSpray(p) ? sprayV(p) : vec2(1.0/0.0,1.0/0.0);\n\n  return v;\n}",particleCount:1e4},{name:"Mouse-driven Julia Set",timeStep:.01,fadeOut:.9,dropProbability:.009,colorMode:3,cx:-.27144999999999997,cy:.14175000000000004,w:6.120699999999999,h:6.120699999999999,particleCount:1e6,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float a = cursor.zw.x;\nfloat b = cursor.zw.y;\nfloat sx = p.x/2.0;\nfloat sy = p.y/2.0;\nfloat i1x = sx*sx - sy*sy+a;\nfloat i1y = -2.0*sx*sy+b;\nfloat i2x = i1x*i1x - i1y*i1y+a;\nfloat i2y = -2.0*i1x*i1y+b;\nfloat i3x = i2x*i2x - i2y*i2y+a;\nfloat i3y = -2.0*i2x*i2y+b;\nfloat i4x = i3x*i3x - i3y*i3y+a;\nfloat i4y = -2.0*i3x*i3y+b;\nfloat i5x = i4x*i4x - i4y*i4y+a;\nfloat i5y = -2.0*i4x*i4y+b;\nfloat i6x = i5x*i5x - i5y*i5y+a;\nfloat i6y = -2.0*i5x*i5y+b;\nfloat i7x = i6x*i6x - i6y*i6y+a;\nfloat i7y = -2.0*i6x*i6y+b;\nfloat i8x = i7x*i7x - i7y*i7y+a;\nfloat i8y = -2.0*i7x*i7y+b;\nfloat i9x = i8x*i8x - i8y*i8y+a;\nfloat i9y = -2.0*i8x*i8y+b;\n\n  float n = sqrt(i9x*i9x+i9y*i9y);\n\nv.x = n > 2.0 ? -p.x/10.0 : p.x/10.0;\nv.y = n > 2.0 ? -p.y/10.0 : p.y/10.0;\n\n  return v;\n}"},{name:"Hyperjump",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.523299999999999,cy:1.2703999999999995,w:48.3842,h:48.3842,code:"vec2 circle(vec2 p, vec2 c) {\n  vec2 c0 = p - c;\n  vec2 p0 = vec2(-c0.y, c0.x);\n  float l = length(p0);\n  return p0 * exp(-l*sin(frame*0.01));\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = circle(p, vec2(0., 0.));\n\n  float r = 7.;\n  for (int i = 0; i < 2; ++i) {\n    float a = 0.01 * frame + float(i) * 2.*PI/7.;\n    v += circle(p, vec2(r * cos(a) , r * sin(a)));\n  }\n  return v;\n}",particleCount:3e4},{name:"Particle Grinder",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.028149999999999675,cy:.08830000000000005,w:9.045300000000001,h:9.045300000000001,code:"vec2 tensor(vec2 p, vec2 c0, vec4 abcd, float N) {\n  vec2 p0 = p - c0;\n  float theta = atan(p0.y, p0.x);\n  float c = cos(N * theta);\n  float s = sin(N * theta);\n  return length(p0) * vec2(abcd[2] * c + abcd[3] * s,\n              abcd[0] * c + abcd[1] * s);\n}\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v = tensor(p, vec2(0., 0.), vec4(-2., 0., 0., 1.), 2.);\n  return v;\n}"},{name:"Hyperbolic flux [interactive]",timeStep:.001,fadeOut:.999,dropProbability:.009,colorMode:3,cx:-.11990000000000034,cy:.018899999999999917,w:8.5442,h:8.5442,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float ax = (cursor.zw.x - p.x);\n  float ay = (cursor.zw.y - p.y);\n  float al = sqrt(ax*ax+ay*ay);\n\n  float rx = (p.x-cursor.xy.x);\n  float ry = (p.y-cursor.xy.y);\n  float rl = sqrt(rx*rx+ry*ry);\n\n  // change this to get a new vector field\n  v.x = (ax*ax*ry + ay*rx*rx)/(al*rl);\n  v.y = (ay*ay*rx + ax*ry*ry)/(al*rl);\n\n  return v;\n}",particleCount:1e6},{name:"Swim against the current",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:3.0524500000000003,cy:-1.3792,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dx1 = cursor.zw.x - p.x;\nfloat dy1 = cursor.zw.y - p.y;\nfloat dl1 = sqrt(dx1*dx1+dy1*dy1);\ndx1 = dx1/dl1;\ndy1 = dy1/dl1;\n\nfloat dx2 = cursor.xy.x - p.x;\nfloat dy2 = cursor.xy.y - p.y;\nfloat dl2 = sqrt(dx2*dx2+dy2*dy2);\ndx2 = dx2/dl2;\ndy2 = dy2/dl2;\n\nfloat fx = cursor.xy.x - cursor.zw.x;\nfloat fy = cursor.xy.y -\ncursor.zw.y;\nfloat fl = sqrt(fx*fx+fy*fy);\nfx = -fx/fl;\nfy = -fy/fl;\n\nfloat d1 = (dx1*fx + dy1*fy)/(dl1*fl);\nfloat d2 = 1.-d1;\nv.x = d1*fx+d2*dx2;\nv.y = d1*fy+d2*dy2;\n\n  return v;\n}",particleCount:100900},{name:"Eye of Sauron (interactive)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.3991000000000007,cy:-.11315000000000008,w:37.0984,h:37.0984,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  // calculate distortion map (reverse solver)\n// the distortion map is based on a sphere, but smoothed to the ends: sqrt(1-(x^8/(x^8-1))^(1/4))\n\nfloat dist_radius = 7.8;\nvec2 distortion = cursor.zw;\nif (length(distortion) > 4.5) {\n    distortion = normalize(distortion) *4.5;\n}\n\n// iterative reverse algo. after all, we knew the result position already, we're trying to reason back to what the original position was\nvec2 d = p;\nfor (int i = 0; i < 10; i++) {\n    // calculate distortion effect magnitude\n    float d_scale = pow(length(d) / dist_radius, 8.);\n    // pseudo sphere map\n    d_scale = pow(1. - pow(d_scale / (d_scale + 1.), .25), .5);\n    d = p - distortion * d_scale;\n}\n\n// calculate differentials, working backwards (i.e. what change in p would result from a change in d)\nvec2 d_dx  = d + vec2(0.1, 0.0);\nfloat d_dx_scale = pow(length(d_dx) / dist_radius, 8.);\nd_dx_scale = pow(1. - pow(d_dx_scale / (d_dx_scale + 1.), .25), .5);\nvec2 dx = (d_dx + distortion * d_dx_scale - p) / 0.1;\n\nvec2 d_dy  = d + vec2(0.0, 0.1);\nfloat d_dy_scale = pow(length(d_dy) / dist_radius, 8.);\nd_dy_scale = pow(1. - pow(d_dy_scale / (d_dy_scale + 1.), .25), .5);\nvec2 dy = (d_dy + distortion * d_dy_scale - p) / 0.1;\n\n// center parts\nfloat pupilrange = length(vec2(d.y, d.x + 6.*sign(d.x)));\nvec2 pupilborder = 2.6*vec2(-d.y, (d.x + 6.*sign(d.x)) );\nv += pupilborder * smoothstep(6.6, 6.8, pupilrange) * (1. - smoothstep(6.9, 7.1, pupilrange));\n\nfloat range = length(d);\nvec2 iris = 7.*d/sqrt(range);\nv += iris * smoothstep(7.0, 7.5, pupilrange) * (1. - smoothstep(3.8, 4.0, range));\n\nvec2 pupil = 1.*vec2(d.x+1.*sign(d.x), d.y);\nv += pupil * (1. - smoothstep(6.6, 6.8, pupilrange));\n\n// absolute parts\nvec2 psign = sign(d);\nvec2 a = abs(d);\nvec2 vabs = vec2(0.0, 0.0);\n\nfloat borderrange = length(vec2(d.x, d.y + 7.*sign(d.y)));\nvec2 border = -1.5*vec2(a.y + 7.*sign(a.y) - 3./(a.y + 1.), -a.x + 3./(a.x + 1.));\nvabs += border * smoothstep(10.8, 11.25, borderrange) * (1. - smoothstep(11.25, 11.7, borderrange)) * smoothstep(3.8, 4.1, range) * (a.y / (a.y + 1.));\n\nvec2 irisborder = 5.*vec2(a.y, -a.x) * (a.y / (a.y + 3.))+ .2 * a;\nvabs += irisborder * smoothstep(3.8, 4.25, range) * (1. - smoothstep(4.25, 4.7, range));\n\nvec2 white = 12.*vec2(1.0, -0.2 * (a.y));\nvabs += white * smoothstep(4.3, 4.5, range) * (1. - smoothstep(11., 11.3, borderrange));\n\nv += vabs * psign;\n\n// outside part\nvec2 outside = d / pow(borderrange - 10., 2.);\nv -= outside * smoothstep(11.3, 11.5, borderrange);\n\n// velocity distortion mapping\nv = v.x * dx + v.y * dy;\n\n// color mapping\nif (length(v) > 0.01) {\n    v = normalize(v) * 10.;\n}\nv = v / (1. + 0.1 * (borderrange - 10.) * smoothstep(11.5, 12.5, borderrange));\n\n\n\n  return v;\n}",particleCount:3e4},{name:"Combination of two fields. One follows cursor",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 p1 = p - vec2(-2., 0.);\nvec2 p2 = p - cursor.zw;\n\nfloat l1 = length(p1), l2 = length(p2);\n\nv = vec2(-p1.y, p1.x)/(l1 * l1) + vec2(-p2.y, p2.x)/(l2 * l2);\n\n  return v;\n}"},{name:"[Randomized] nice symmetry",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:-2.6390499999999992,cy:-1.1419499999999996,w:46.508700000000005,h:46.508700000000005,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = p.y/cos(length(p));\n  v.y = max((log(p.y)+p.x),p.x);\n\n  return v;\n}",particleCount:2e4},{name:"A city block from a parallel Universe (by @MananG_8)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:1,cx:.6165500000000002,cy:-1.87745,w:9.0455,h:9.0455,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = sin(tan(p.x))*cos(tan(p.y));\n  v.y = sin(tan(p.y))*cos(tan(p.x));\n\n  return v;\n}\n",particleCount:2e4},{name:"♥ by @SAKrisT",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:-1.4246499999999997,cy:.92285,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float size = 1.0;\n  vec2 o = (p)/(1.6* size);\n  float a = o.x*o.x+o.y*o.y-0.3;\n  v = vec2(step(a*a*a, o.x*o.x*o.y*o.y*o.y));\n\n  return v;\n}\n"},{name:"Dynamic vector field by Evgeniy Andreev. Not defined by physical system, but beautiful.",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-1.6564499999999995,cy:-.36424999999999974,w:24.7317,h:24.7317,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dt = 0.01;\n  float t = frame*dt;\n  float w = 2.*PI/5.;\n  float A = 2.;\n\n  float d = sqrt(p.x*p.x + p.y*p.y);\n  v.x = A*cos(w*t/d);\n  v.y = A*sin(w*t/d);\n\n  return v;\n}",particleCount:3e3},{name:"Behold (by /u/censored_username)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.12704999999999966,cy:.1923499999999998,w:22.5709,h:22.5709,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = abs(p.x) - 5.;\n  float side = sign(p.x);\n  float range = length(vec2(x, p.y));\n  float irisrange = length(vec2(x, p.y + 2.*sign(p.y)));\n\n  vec2 border = 1.*vec2(p.y + 2.2*sign(p.y) * (p.y*p.y / (p.y*p.y + 0.01)), -x);\n\n  vec2 outside = vec2(x / (1.+10./abs(p.x*p.x)), p.y);\n\n  vec2 spiral = vec2(p.y, -x);\n\n  vec2 iris = sin(-range * 10.) * spiral + 0.05*vec2(x, p.y);\n\n  v += outside * (smoothstep(4.0, 4.5, irisrange)/range*5. - 5.*smoothstep(0.9, 0.7, range)/range);\n  v += border * smoothstep(3.5, 4., irisrange) * smoothstep(4.5, 4., irisrange);\n  v += iris * smoothstep(2.0, 1.5, range) * smoothstep(0.8, 1., range);\n  v -= 10.0*spiral * smoothstep(1.0, 0.8, range) * smoothstep(0.7, 0.9, range);\n\n  v.x *= side;\n  v *= -1.;\n\n  return v;\n}",particleCount:3e4},{name:"README 1",timeStep:.007,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-1.275949999999999,cy:-1.6277,w:30.2937,h:30.2937,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = length(p)*min(sin(p.y),cos(p.x));\nv.y = cos((p.y+p.y));\n\n\n  return v;\n}"},{name:"README 2",timeStep:.007,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-1.275949999999999,cy:-1.62765,w:30.2937,h:30.2937,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = cos(p.y);\nv.y = cos(p.x);\n\n\n  return v;\n}"},{name:"README 3",timeStep:.02,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.21419999999999995,cy:-.7710999999999997,w:55.970200000000006,h:55.970200000000006,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = min(sin(exp(p.x)),sin(length(p)));\nv.y = sin(p.x);\n\n\n  return v;\n}"},{name:"README 4",timeStep:.02,fadeOut:.998,dropProbability:.009,colorMode:1,cx:2.43185,cy:-1.1695,w:11.4385,h:11.4385,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = (p.y+cos(p.y));\nv.y = sin(min(length(p),log((p.y+p.x))*p.x));\n\n\n  return v;\n}"},{name:"True Dipole",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = p.x;\nfloat y = p.y;\n\n// true dipole\nv.x = 2.0*x*y;\nv.y = y*y - x*x;\n\n  return v;\n}"},{name:"Flow profile of a sphere",timeStep:.011,fadeOut:.99999,dropProbability:.009,colorMode:1,cx:-.7177000000000002,cy:-.11769999999999992,w:11.434999999999999,h:11.434999999999999,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = p.x;\nfloat y = p.y;\nfloat r = sqrt(x*x+y*y);\nfloat sinth = y/r;\nfloat costh = x/r;\nfloat R = 1.;\nfloat Uinf = 1.;\n// radial flow\nfloat ur = Uinf*(1.-1.5*R/r+0.5*R*R*R/(r*r*r))*costh;\n// theta flow\nfloat uth = Uinf*(-1.+0.75*R/r+0.25*R*R*R/(r*r*r))*sinth;\n// to ux uy\nv.x = costh*ur-sinth*uth;\nv.y = sinth*ur+costh*uth;\n\n  return v;\n}",particleCount:7e3},{name:"Best vortex",colorMode:2,cx:-6.158449999999998,cy:-.9834499999999995,w:96.8415,h:96.8415,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float r = length(p);\nfloat theta = atan(p.y, p.x);\nv = vec2(p.y, -p.x) / r;\nfloat t = sqrt(r * 10.) + theta + frame * .02;\nv *= sin(t);\nv *= length(v) * 10.;\nv += p * .2;\n\n  return v;\n}",timeStep:.01,fadeOut:.9,dropProbability:.009,particleCount:1e5},{name:"Black hole",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.47934999999999994,cy:.3591500000000001,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float a = .1;\nfloat r2 = p.x * p.x + p.y * p.y;\nv = vec2(p.y, -p.x) / r2 - a * p;\n\n  return v;\n}"},{name:"Julia set",timeStep:.004,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.40235,cy:-.01795000000000002,w:5.0845,h:5.0845,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 c = p;\nvec2 z = vec2(.4, .5);\nfor (int i = 0; i < 8; i++) {\n   c = vec2(c.x * c.x - c.y * c.y, c.y * c.x + c.x * c.y);\n   c += z;\n}\nv = c;\n\n\n  return v;\n}",particleCount:1e4},{name:"Mandelbrot set",timeStep:.004,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-.5678,cy:-.07015000000000005,w:4.9902,h:4.9902,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 z = p;\nfor(int k=0; k<50; k++) {\nz = vec2(z.x * z.x - z.y * z.y, 2. * z.x * z.y) + p;\n}\n\nfloat mask = step(length(z), 2.);\nv.x = -p.y/length(p) * (0.5 - mask);\nv.y = p.x/length(p) * (0.5 - mask);\n\n\n\n\n  return v;\n}",particleCount:3e4},{name:"Reflecting pool",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = sin(5.0*p.y + p.x);\nv.y = cos(5.0*p.x - p.y);\n\n  return v;\n}"},{name:"Shear zone",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.539734222673566,h:8.539734222673566,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float r = length(p) - 1.5;\nfloat c = 1.0/(1.0+exp(-5.0*r));\nfloat vx1 = -p.y,  // circle\n      vy1 = p.x;\nfloat vx2 = 0.2*p.x+p.y, // spiral\n      vy2 = 0.2*p.y-p.x;\nv.x = c*vx1 + (1.0-c)*vx2;\nv.y = c*vy1 + (1.0-c)*vy2;\n\n\n  return v;\n}"},{name:"Beautiful field",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-1.6564499999999995,cy:-.36424999999999974,w:24.7317,h:24.7317,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dt = 0.01;\nfloat t = frame*dt;\nfloat w = 2.*PI/5.;\nfloat A = 2.;\n\nfloat d = sqrt(p.x*p.x + p.y*p.y);\nv.x = A*cos(w*t/d);\nv.y = A*sin(w*t/d);\n\n  return v;\n}",particleCount:3e3}]},"7l3+":function(e,n,t){"use strict";function r(){var e=0;_.forEach(function(n){return e+=n.getProbability()}),_.forEach(function(n){return n.probability=n.getProbability()/e})}function o(){for(var e,n=Math.random(),t=0,r=0;r<_.length&&(e=_[r],t+=e.probability,!(n<t));++r);if(!e)throw new Error("no more items");return e.render()}function a(){return r(),"v.x = "+o()+";\n  v.y = "+o()+";"}n.a=a;var i=t("Zx67"),c=t.n(i),u=t("zwoO"),s=t.n(u),d=t("Pf15"),l=t.n(d),v=t("Zrlr"),f=t.n(v),p=t("wxAW"),x=t.n(p),y={POINT:10,LENGTH:5,TRIGONOMETRY:9,ARITHMETICS:6,MINMAX:4,EXP:1,SIGN:.1},m=function(){function e(n){f()(this,e),this.probability=0,this.className=n}return x()(e,[{key:"getProbability",value:function(){return y[this.className]}},{key:"render",value:function(){return""}}]),e}(),g=function(e){function n(e,t){f()(this,n);var r=s()(this,(n.__proto__||c()(n)).call(this,t));return r.operator=e,r}return l()(n,e),x()(n,[{key:"render",value:function(){var e=this.p,e=this.getProbability();y[this.className]*=.25,r();var n=o();return y[this.className]=e,r(),this.operator(n)}}]),n}(m),h=function(e){function n(e,t){f()(this,n);var r=s()(this,(n.__proto__||c()(n)).call(this,t));return r.operator=e,r}return l()(n,e),x()(n,[{key:"render",value:function(){var e=this.getProbability();y[this.className]*=.25,r();var n=o(),t=o();return y[this.className]=e,r(),this.operator(n,t)}}]),n}(m),b=function(e){function n(e,t){f()(this,n);var r=s()(this,(n.__proto__||c()(n)).call(this,t));return r.constant=e,r}return l()(n,e),x()(n,[{key:"render",value:function(){return this.constant}}]),n}(m),_=[new b("p.x","POINT"),new b("p.y","POINT"),new b("length(p)","LENGTH"),new g(function(e){return"sin("+e+")"},"TRIGONOMETRY"),new g(function(e){return"cos("+e+")"},"TRIGONOMETRY"),new h(function(e,n){return e+"*"+n},"ARITHMETICS"),new h(function(e,n){return e+"/"+n},"ARITHMETICS"),new h(function(e,n){return"("+e+"+"+n+")"},"ARITHMETICS"),new h(function(e,n){return"("+e+"-"+n+")"},"ARITHMETICS"),new h(function(e,n){return e===n?e:"min("+e+","+n+")"},"MINMAX"),new h(function(e,n){return e===n?e:"max("+e+","+n+")"},"MINMAX"),new g(function(e){return"log("+e+")"},"EXP"),new g(function(e){return"exp("+e+")"},"EXP"),new h(function(e,n){return"pow("+e+", "+n+")"},"EXP"),new g(function(e){return"abs("+e+")"},"SIGN"),new g(function(e){return"sign("+e+")"},"SIGN")]},"85ps":function(e,n,t){"use strict";function r(e){return t.i(s.a)(e).then(function(n){if(n.error)return n;e=n.getCode();var t=d.check(e,{globals:l});return t.code=e,t.log.errorCount&&(t.error=o(t.log)),t})}function o(e){var n=e.diagnostics[0],t=n.range,r=t.lineColumn(),o=t.source,c=o._lineOffsets[r.line],u=o.contents.substr(c,r.column);u+=o.contents.substring(t.start,t.end);var s="Line "+r.line+": ",d=n.text;return{error:s+u+"\n"+i(s.length)+i(r.column)+"^",errorDetail:d,isFloatError:a(d)}}function a(e){return e.indexOf('"int"')>-1&&e.indexOf('"float"')>-1}function i(e){return new Array(e+1).join(" ")}n.a=r;var c=t("eBcr"),u=t.n(c),s=t("svlg"),d={check:function(e){return{code:e,log:{errorCount:0}}}};t.e(2).then(function(){d=t("TFw8"),u.a.fire("glsl-parser-ready")}.bind(null,t)).catch(t.oe);var l="\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}"},"94y8":function(e,n,t){"use strict";function r(e){function n(){a.a.off("audio",r),o.deleteTexture(u)}function t(){if(s){s=!1;o.bindTexture(o.TEXTURE_2D,u),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,5,5,0,o.RGBA,o.UNSIGNED_BYTE,c),o.bindTexture(o.TEXTURE_2D,null)}}function r(e){c=e,s=!0}var o=e.gl,c=new Uint8Array(256),u=i.a.createTexture(o,o.NEAREST,c,8,8),s=!1;return e.audioTexture=u,a.a.on("audio",r),{updateTextures:t,dispose:n}}var o=t("eBcr"),a=t.n(o),i=t("Ddjs");n.a=r},C8nW:function(e,n,t){"use strict";function r(e,n){function t(t,r){function o(e){e.lengthComputable&&n.progress({loaded:e.loaded,total:e.total,percent:e.loaded/e.total})}function a(){if(200!==u.status)return void r("Unexpected status code "+u.status+" when calling "+e);var o=u.response;"json"===n.responseType&&"string"==typeof o&&(o=JSON.parse(o)),t(o)}function i(){r("Failed to download "+e)}function c(){r("Cancelled download of "+e)}var u=new XMLHttpRequest;"function"==typeof n.progress&&u.addEventListener("progress",o,!1),u.addEventListener("load",a,!1),u.addEventListener("error",i,!1),u.addEventListener("abort",c,!1),u.open("GET",e),n.responseType&&(u.responseType=n.responseType),u.send(null)}return n||(n={}),new a.a(t)}n.a=r;var o=t("//Fk"),a=t.n(o)},Ddjs:function(e,n,t){"use strict";function r(e,n,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n)}function o(e,n){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),t}function a(e,n,t,r,o){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),t instanceof Uint8Array?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,o,0,e.RGBA,e.UNSIGNED_BYTE,t):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),a}function i(e,n,t){e.bindFramebuffer(e.FRAMEBUFFER,n),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}function c(e,n,t,r){e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r,e.FLOAT,!1,0,0)}function u(e,n,t){function r(){e.deleteProgram(o)}var o=e.createProgram(),a=s(e,e.VERTEX_SHADER,n),i=s(e,e.FRAGMENT_SHADER,t);if(e.attachShader(o,a),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(o));var c,u={program:o,unload:r},d=e.getProgramParameter(o,e.ACTIVE_ATTRIBUTES);for(c=0;c<d;c++){var l=e.getActiveAttrib(o,c);u[l.name]=e.getAttribLocation(o,l.name)}var v=e.getProgramParameter(o,e.ACTIVE_UNIFORMS);for(c=0;c<v;c++){var f=e.getActiveUniform(o,c);u[f.name]=e.getUniformLocation(o,f.name)}return u}function s(e,n,t){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r}n.a={createTexture:a,bindFramebuffer:i,createProgram:u,createBuffer:o,bindAttribute:c,bindTexture:r}},DuZ1:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),l=t("Pf15"),v=t.n(l),f=t("4KA4"),p=t("JjDM"),x=t("bvb0"),y=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.updateCode=e||"",t}return v()(n,e),u()(n,[{key:"setNewUpdateCode",value:function(e){this.updateCode=e}},{key:"getDefines",value:function(){return"\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\n#define PI 3.1415926535897932384626433832795\n\n"+t.i(x.a)()+"\n"}},{key:"getFunctions",value:function(){return"\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n"+p.a+"\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n"+(this.updateCode?this.updateCode:"vec2 get_velocity(vec2 p) { return vec2(0.); }")+"\n  "}}]),n}(f.a);n.a=y},FaU1:function(e,n,t){"use strict";function r(e,n,t){if(0==e)return n[t+0]=0,n[t+1]=0,n[t+2]=0,void(n[t+3]=0);var r=Math.abs(e),o=Math.floor(c()(r));o+=a(o)<=r/2?1:0,o-=a(o)>r?1:0;var i;i=o>100?r/1024/a(o-10)-1:r/a(o)-1;var u=o+127;i*=256;var s=Math.floor(i);i-=s,i*=256;var d=Math.floor(i);i-=d,i*=128;var l=2*Math.floor(i)+(e<0?1:0);n[t+0]=u,n[t+1]=s,n[t+2]=d,n[t+3]=l}function o(e,n,t,r){var o=Math.floor(e+.5),i=Math.floor(n+.5),c=Math.floor(t+.5),u=Math.floor(r+.5),s=o-127;return(1-u%2*2)*((o>0?1:0)+i/256+c/65536+Math.floor(u/2)/8388608)*a(s)}function a(e){return Math.exp(e*Math.LN2)}n.a=r,n.b=o;var i=t("yI0F"),c=t.n(i)},"I6d+":function(e,n,t){"use strict";function r(e,n,r){function i(e){r&&r.error&&r.error(e)}function c(e){l=e,u.a.fire("refresh-speed"),r&&r.done&&r.done(n)}function d(n,t){if(l){var r=t+s;a.a.bindTexture(e.gl,l,r),e.gl.uniform1i(n["input"+t],r)}}var l=null;return t.i(o.a)(e.gl,n).then(c).catch(i),{updateBinding:d,dispose:function(){e.gl.deleteTexture(l)}}}n.a=r;var o=t("egvE"),a=t("Ddjs"),i=t("rvz5"),c=t("eBcr"),u=t.n(c),s=i.a.FREE_TEXTURE_UNIT},JHsM:function(e,n,t){"use strict";function r(e){function n(e){if(e){var n=s()({},H.bbox);if(r(e,"minX",n),r(e,"minY",n),r(e,"maxX",n),r(e,"maxY",n),void 0!==e.minY||void 0!==e.maxY){var t=Math.abs(n.minY-n.maxY)/Math.abs(H.bbox.minY-H.bbox.maxY),o=(H.bbox.maxX+H.bbox.minX)/2,a=(H.bbox.maxX-H.bbox.minX)/2;n.minX=o-a*t,n.maxX=o+a*t}z(n)}}function r(e,n,t){var r=c()(e[n]);a()(r)&&(t[n]=r)}function o(e){L=e}function i(){L=null}function u(e){var n=parseInt(e,10);x.a.setColorMode(n),H.colorMode=x.a.getColorMode(),Q.updateColorMode(n)}function l(){return x.a.getColorMode()}function f(){return x.a.getIntegrationTimeStep()}function w(e){var n=parseFloat(e);a()(n)&&(H.integrationTimeStep=n,x.a.setIntegrationTimeStep(n),p.a.fire("integration-timestep-changed",n))}function T(e){Z=e,D()}function E(e){var n=parseFloat(e);a()(n)&&(H.fadeOpacity=n,x.a.setFadeout(n))}function P(){return x.a.getFadeout()}function M(){return x.a.getParticleCount()}function S(e){a()(e)&&e!==W&&(e<1||(N(e),W=e,x.a.setParticleCount(e)))}function R(e){var n=parseFloat(e);a()(n)&&(x.a.setDropProbability(n),H.dropProbability=n)}function A(){return x.a.getDropProbability()}function C(){F(window.innerWidth,window.innerHeight),J.updateScreenTextures(),Y(q)}function F(n,t){var r=Math.max(.02*n,30),o=Math.max(.02*t,30);G.width=n+2*r,G.height=t+2*o,G.top=-o,G.left=-r;var a=e.canvas;a.width=G.width,a.height=G.height,a.style.left=-r+"px",a.style.top=-o+"px"}function B(){I(),te.dispose(),window.removeEventListener("resize",C,!0),$.dispose(),ee.dispose()}function D(){j||Z||(j=requestAnimationFrame(X))}function I(){cancelAnimationFrame(j),j=0}function X(){j=0,O(),L&&L.capture(e.canvas),D()}function O(){J.fadeOutLastFrame(),Q.drawParticles(),J.renderCurrentScreen(),Q.updateParticlesPositions()}function N(e){H.particleStateResolution=Math.ceil(Math.sqrt(e)),Q.updateParticlesCount()}function U(){var e=x.a.getBBox(),n=G.width,t=G.height,r=Math.PI*Math.E,o=Math.PI*Math.E,a=0,i=0;e&&(r=e.maxX-e.minX,o=e.maxY-e.minY,a=n*(e.minX+e.maxX)/2,i=n*(e.minY+e.maxY)/2);var c=r*n/2,u=o*t/2;te.showRectangle({left:-c+a,top:-u-i,right:c+a,bottom:u-i})}function Y(e){function n(n){return(n-e.x)/e.scale}function t(n){return(n-e.y)/e.scale}J.boundingBoxUpdated=!0,q.x=e.x,q.y=e.y,q.scale=e.scale;var r=G.width,o=G.height,a=n(0),i=t(0),c=n(r),u=t(o),s=1e4;V.minX=Math.round(s*a/r)/s,V.minY=Math.round(s*-i/r)/s,V.maxX=Math.round(s*c/r)/s,V.maxY=Math.round(s*-u/r)/s,x.a.saveBBox(V),p.a.fire("bbox-change",V)}function k(){var e=Math.PI*Math.E*.5,n=Math.PI*Math.E*.5;z({minX:-e,minY:-n,maxX:e,maxY:n})}function z(e){x.a.saveBBox(e),U(),te.moveBy(0,0,!1)}var G={width:0,height:0,top:0,left:0};F(e.canvas.width,e.canvas.height),window.addEventListener("resize",C,!0),p.a.on("start-record",o),p.a.on("stop-record",i);var L=null,V=x.a.getBBox()||{},q={scale:1,x:0,y:0},W=x.a.getParticleCount();e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST);var j,H={gl:e,bbox:V,canvasRect:G,inputs:null,framebuffer:e.createFramebuffer(),quadBuffer:d.a.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),colorMode:x.a.getColorMode(),colorFunction:x.a.getColorFunction(),screenTextureUnit:3,integrationTimeStep:x.a.getIntegrationTimeStep(),dropProbability:x.a.getDropProbability(),frame:0,cursor:{clickX:0,clickY:0,hoverX:0,hoverY:0},particleStateResolution:0,fadeOpacity:x.a.getFadeout(),audioTexture:null},Z=!1,K=t.i(_.a)(H),J=t.i(m.a)(H),Q=t.i(g.a)(H),$=t.i(h.a)(H),ee=t.i(b.a)(Q);N(W);var ne={start:D,stop:I,dispose:B,resetBoundingBox:k,moveBoundingBox:n,applyBoundingBox:z,setPaused:T,getParticlesCount:M,setParticlesCount:S,setFadeOutSpeed:E,getFadeOutSpeed:P,setDropProbability:R,getDropProbability:A,getIntegrationTimeStep:f,setIntegrationTimeStep:w,setColorMode:u,getColorMode:l,vectorFieldEditorState:ee,inputsModel:K,getCanvasRect:function(){return G},getBoundingBox:function(){return H.bbox}},te=function(){return v()(e.canvas,{controller:t.i(y.a)(e.canvas,Y)})}();return U(),setTimeout(function(){p.a.fire("scene-ready",ne)}),ne}n.a=r;var o=t("AMV0"),a=t.n(o),i=t("5dBV"),c=t.n(i),u=t("woOf"),s=t.n(u),d=t("Ddjs"),l=t("yBIK"),v=t.n(l),f=t("eBcr"),p=t.n(f),x=t("NEgR"),y=t("p0IO"),m=t("h62Y"),g=t("pKWO"),h=t("p9aJ"),b=t("c5hq"),_=t("/eR5")},JjDM:function(e,n,t){"use strict";n.a="\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n"},NEgR:function(e,n,t){"use strict";function r(){var e=D.get("cm");return _(e)?e:O.colorMode}function o(e){_(e)&&(D.set({cm:e}),I.cm=e)}function a(){return D.get("cf")||""}function i(e){D.set({cf:e}),I.cf=e}function c(){var e=D.get("fo");return _(e)?e:O.fadeout}function u(e){_(e)&&(D.set({fo:e}),I.fo=e)}function s(){var e=D.get("pc");return _(e)?e:O.particleCount}function d(e){_(e)&&(D.set({pc:e}),I.pc=e)}function l(){var e=D.get("dt");return _(e)?e:O.timeStep}function v(e){_(e)&&(D.set({dt:e}),I.dt=e)}function f(){var e=D.get("dp");return _(e)?e:O.dropProbability}function p(e){_(e)&&(w(e,0,1),D.set({dp:e}))}function x(){return y(D.get("cx"),D.get("cy"),D.get("w"),D.get("h"))}function y(e,n,t,r){if(_(e)&&_(n)&&_(t)&&_(r)){var o=t/2,a=r/2,i=1e4;return{minX:Math.round(i*(e-o))/i,maxX:Math.round(i*(e+o))/i,minY:Math.round(i*(n-a))/i,maxY:Math.round(i*(n+a))/i}}}function m(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e={cx:.5*(e.minX+e.maxX),cy:.5*(e.minY+e.maxY),w:e.maxX-e.minX,h:e.maxX-e.minX},e.w<=0||e.h<=0||(I.cx=e.cx,I.cy=e.cy,I.w=e.w,I.h=e.h,T&&(clearTimeout(T),T=0),n?D.set(e):T=setTimeout(function(){T=0,D.set(e)},300))}function g(){var e=D.get("vf");if(e)return e;var n=D.get("code");return n?(e=t.i(F.a)(n),delete I.code,D.set("vf",e),e):X}function h(){return X}function b(e){D.set({vf:e}),I.code=e}function _(e){return P()(e)}function w(e,n,t){return e<n?n:e>t?t:e}var T,E=t("AMV0"),P=t.n(E),M=t("3zJd"),S=t.n(M),R=t("eBcr"),A=t.n(R),C=t("6c6E"),F=t("cj2E"),B=t("bwl9"),D=S()({},{useSearch:!0,rewriteHashToSearch:!0}),I=D.get(),X=t.i(F.a)("v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;"),O={timeStep:.01,dropProbability:.009,particleCount:1e4,fadeout:.998,colorMode:C.a.UNIFORM},N={collapsed:t.i(B.a)()};n.a={settingsPanel:N,saveBBox:m,getBBox:x,makeBBox:y,getQS:function(){return D},saveCode:b,getCode:g,getDefaultCode:h,getDropProbability:f,setDropProbability:p,getIntegrationTimeStep:l,setIntegrationTimeStep:v,getParticleCount:s,setParticleCount:d,getFadeout:c,setFadeout:u,getColorMode:r,setColorMode:o,getColorFunction:a,setColorFunction:i},D.onChange(function(){A.a.fire("scene-ready",window.scene)})},Qv35:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),a=t("zwoO"),i=t.n(a),c=t("Pf15"),u=t.n(c),s=t("Zrlr"),d=t.n(s),l=t("wxAW"),v=t.n(l),f=t("4KA4"),p=t("XMEc"),x=t("S+/9"),y=t("DuZ1"),m=t("vhRe"),g=t("i69e"),h=function(){function e(n){d()(this,e),this.readStoredPosition=new p.a(!0),this.udfVelocity=new y.a,this.integratePositions=new g.a,this.dropParticles=new b,this.writeComputedPosition=new p.a(!1),this.panZoomDecode=new m.a({decode:!0}),this.panZoomEncode=new m.a({decode:!1}),this.colorMode=n&&n.colorMode}return v()(e,[{key:"setCustomVectorField",value:function(e){this.udfVelocity.setNewUpdateCode(e)}},{key:"getVertexShader",value:function(){return"precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}"}},{key:"getFragmentShader",value:function(){var e=[this.readStoredPosition,this.dropParticles,this.udfVelocity,this.integratePositions,{getMainBody:function(){return"\n  vec2 newPos = pos + velocity;\n  "}},this.writeComputedPosition];return t.i(x.a)(e)}}]),e}();n.a=h;var b=function(e){function n(){return d()(this,n),i()(this,(n.__proto__||o()(n)).apply(this,arguments))}return u()(n,e),v()(n,[{key:"getDefines",value:function(){return"\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n"}},{key:"getFunctions",value:function(){return"\n"}},{key:"getMainBody",value:function(){return"\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n"}}]),n}(f.a)},"S+/9":function(e,n,t){"use strict";function r(e){function n(e){e&&t.push(e)}var t=[];return e.forEach(function(e){e.getDefines&&n(e.getDefines())}),e.forEach(function(e){e.getFunctions&&n(e.getFunctions())}),n("void main() {"),e.forEach(function(e){e.getMainBody&&n(e.getMainBody())}),n("}"),t.join("\n")}n.a=r},V39N:function(e,n,t){"use strict";function r(){function e(){n=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY}var n,t;return{getMin:function(){return n},getMax:function(){return t},add:function(e){e<n&&(n=e),e>t&&(t=e)},reset:e}}n.a=r},XFig:function(e,n,t){"use strict";n.a="\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n"},XMEc:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),l=t("Pf15"),v=t.n(l),f=t("4KA4"),p=t("a8s+"),x=t("XFig"),y=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.isDecode=e,t}return v()(n,e),u()(n,[{key:"getFunctions",value:function(){if(this.isDecode)return"\n    "+p.a+"\n    "+x.a+"\n"}},{key:"getDefines",value:function(){if(this.isDecode)return"\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n"}},{key:"getMainBody",value:function(){return this.isDecode?"\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n":"\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n"}}]),n}(f.a);n.a=y},YJWA:function(e,n,t){"use strict";function r(e){if(!l)return void t.e(1).then(function(){l=t("nI+d"),window.stopRecord=a,r(e)}.bind(null,t)).catch(t.oe);if(v&&v.stop(),!o()){var n=document.createElement("script");return n.setAttribute("src",e||"http://localhost:8080/ffmpegserver/ffmpegserver.js"),n.onload=function(){return r(e)},void document.head.appendChild(n)}v=new l({format:"ffmpegserver",framerate:60,verbose:!0,name:"fieldplay",extension:".mp4",codec:"mpeg4",ffmpegArguments:["-b:v","12M"]}),window.isRecording=!0,v.start(),u.a.fire("start-record",v)}function o(){return"undefined"!=typeof FFMpegServer}function a(){window.isRecording=!1,u.a.fire("stop-record",v),v.stop(),v.save()}Object.defineProperty(n,"__esModule",{value:!0});var i=t("JHsM"),c=t("eBcr"),u=t.n(c),s=t("sbZs"),d=document.getElementById("scene");d&&function(e){e.width=window.innerWidth,e.height=window.innerHeight;var n={antialiasing:!1},r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);if(r){window.webGLEnabled=!0;var o=t.i(i.a)(r);o.start(),t.i(s.a)(o),window.scene=o}else window.webGLEnabled=!1}(d),t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var l,v;window.startRecord=r,window.isRecording=!1},"a8s+":function(e,n,t){"use strict";n.a="\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n"},aZPT:function(e,n,t){"use strict";function r(e,n){e.getMethods&&n.push(e.getMethods())}function o(e,n){e.getMain&&n.push(e.getMain())}function a(){function e(){return"\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    "}function n(){return"\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n"}return{getVariables:e,getMain:n}}var i=t("Zrlr"),c=t.n(i),u=t("wxAW"),s=t.n(u),d=t("XFig"),l=t("c5NW"),v=function(){function e(n){c()(this,e),this.colorMode=n.colorMode,this.colorFunction=n.colorFunction||""}return s()(e,[{key:"getFragmentShader",value:function(){return"precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}"}},{key:"getVertexShader",value:function(e){var n=a(),i=t.i(l.a)(this.colorMode,e,this.colorFunction),c=[];r(n,c),r(i,c);var u=[];return o(n,u),o(i,u),"precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n"+(n.getVariables()||"")+"\n"+i.getVariables()+"\n\n"+d.a+"\n\n"+c.join("\n")+"\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n"+u.join("\n")+"\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}"}}]),e}();n.a=v},bvb0:function(e,n,t){"use strict";function r(){return"uniform sampler2D input0;\nuniform sampler2D input1;"}n.a=r},bwl9:function(e,n,t){"use strict";function r(){return window.innerWidth<600}n.a=r},c5NW:function(e,n,t){"use strict";function r(e,n,t){function r(){return"\nuniform vec2 u_velocity_range;\nvarying vec4 v_particle_color;\n\n"+d.getDefines()+"\n"+l.getDefines()+"\n"}function c(){return"\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n"+d.getFunctions()+"\n"+l.getFunctions()+"\n"+u()+"\n"}function u(){if(e===i.a.UNIFORM)return"\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n";if(e===i.a.VELOCITY)return"\nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n  return vec4(hsv2rgb(vec3(0.05 + (1. - speed) * 0.5, 0.9, 1.)), 1.0);\n}\n";if(e===i.a.CUSTOM){if(!t)throw new Error("color mode is set to custom, but no color function is specified");return t}return" \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n"}function s(){return"  v_particle_color = get_color(v_particle_pos);"}var d=new o.a(n),l=new a.a;return{getVariables:r,getMain:s,getMethods:c}}n.a=r;var o=t("DuZ1"),a=t("i69e"),i=t("6c6E")},c5hq:function(e,n,t){"use strict";function r(e){function n(){a.a.off("glsl-parser-ready",s)}function r(){return i.a.getCode()}function o(e){if(e===f)return void(l&&l.error&&s());d(e).then(function(n){if(!n.cancelled){if(n&&n.error)return u(n.error),n;f=e,p.code=e,i.a.saveCode(e)}})}function u(e){e&&e.error?(p.error=e.error,p.errorDetail=e.errorDetail,p.isFloatError=e.isFloatError):(p.error="",p.errorDetail="",p.isFloatError=!1)}function s(e){return t.i(c.a)(e||f).then(function(e){return l=e,u(l.error),l})}function d(n){v+=1;var t=v;return s(n).then(function(n){if(t!==v)return n.cancelled=!0,n;if(n.error)return n;try{return e.updateCode(n.code),n}catch(e){return{error:{error:e.message}}}})}a.a.on("glsl-parser-ready",s);var l,v=0,f=i.a.getCode();!function(){var e=i.a.getCode();e?d(e).then(function(e){e.error&&(console.error("Failed to restore previous vector field: ",e.error),d(i.a.getDefaultCode()))}):d(i.a.getDefaultCode())}();var p={getCode:r,setCode:o,dispose:n,code:f,error:"",errorDetail:"",isFloatError:!1};return p}n.a=r;var o=t("eBcr"),a=t.n(o),i=t("NEgR"),c=t("85ps")},cj2E:function(e,n,t){"use strict";function r(e){return"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  "+e+"\n\n  return v;\n}"}n.a=r},eBcr:function(e,n,t){var r=t("puH/");e.exports=r({})},egvE:function(e,n,t){"use strict";function r(e,n){function t(e){c(e)}function r(){var n=e.createTexture(),t=e.RGBA,r=e.RGBA,i=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t,r,i,u),o(u.width)&&o(u.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),a(n)}var a,c,u=new Image;return u.crossOrigin="",u.onload=r,u.onerror=t,u.src=n,new i.a(function(e,n){a=e,c=n})}function o(e){return 0==(e&e-1)}n.a=r;var a=t("//Fk"),i=t.n(a)},gIFv:function(e,n,t){"use strict";function r(e){function n(){c.a.off("integration-timestep-changed",i),c.a.off("bbox-change",i),c.a.off("refresh-speed",i),r()}function r(){m&&E.deleteTexture(m),y&&E.deleteTexture(y)}function i(){h&&clearTimeout(h),h=setTimeout(function(){T=!0,h=0},50)}function u(e){E.uniform2f(e.u_velocity_range,P.getMin(),P.getMax())}function v(){r(),g=e.particleStateResolution,b=g*g,_=new Uint8Array(4*b),w=new Uint8Array(4*b),m=a.a.createTexture(E,E.NEAREST,_,g,g),y=a.a.createTexture(E,E.NEAREST,w,g,g),i()}function f(){i()}function p(n){T&&_&&w&&(T=!1,a.a.bindFramebuffer(E,e.framebuffer,m),E.uniform1i(n.u_out_coordinate,d),E.drawArrays(E.TRIANGLES,0,6),E.readPixels(0,0,g,g,E.RGBA,E.UNSIGNED_BYTE,_),a.a.bindFramebuffer(E,e.framebuffer,y),E.uniform1i(n.u_out_coordinate,l),E.drawArrays(E.TRIANGLES,0,6),E.readPixels(0,0,g,g,E.RGBA,E.UNSIGNED_BYTE,w),x())}function x(){P.reset();for(var e=0;e<w.length;e+=4){var n=o(_,e),t=o(w,e),r=Math.sqrt(n*n+t*t);P.add(r)}}var y,m,g,h,b,_,w,T=!0,E=e.gl,P=t.i(s.a)();return function(){c.a.on("integration-timestep-changed",i),c.a.on("bbox-change",i),c.a.on("refresh-speed",i)}(),{updateCode:f,updateParticlesPositions:p,updateParticlesCount:v,setColorMinMax:u,requestSpeedUpdate:i,dispose:n}}function o(e,n){return t.i(u.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var a=t("Ddjs"),i=t("eBcr"),c=t.n(i),u=t("FaU1"),s=t("V39N"),d=6,l=7},h62Y:function(e,n,t){"use strict";function r(e){function n(){o.a.bindFramebuffer(d,e.framebuffer,u),d.viewport(0,0,l.width,l.height),y.boundingBoxUpdated&&f?(v.dx=-(e.bbox.minX-f.minX)/(e.bbox.maxX-e.bbox.minX),v.dy=-(e.bbox.minY-f.minY)/(e.bbox.maxY-e.bbox.minY),v.scale=(e.bbox.maxX-e.bbox.minX)/(f.maxX-f.minX),c(s,e.fadeOpacity,v)):c(s,e.fadeOpacity,a)}function t(){o.a.bindFramebuffer(d,null),i(),d.enable(d.BLEND),d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA),d.clearColor(p.r,p.g,p.b,p.a),d.clear(d.COLOR_BUFFER_BIT),c(u,1,a),d.disable(d.BLEND);var e=s;s=u,u=e,y.boundingBoxUpdated=!1,window.audioTexture&&c(window.audioTexture,1,a)}function r(){var e=l.width,n=l.height,t=new Uint8Array(e*n*4);u&&d.deleteTexture(u),s&&d.deleteTexture(s),u=o.a.createTexture(d,d.NEAREST,t,e,n),s=o.a.createTexture(d,d.NEAREST,t,e,n)}function i(){if(!f)return void(f={minX:e.bbox.minX,minY:e.bbox.minY,maxX:e.bbox.maxX,maxY:e.bbox.maxY});f.minX=e.bbox.minX,f.minY=e.bbox.minY,f.maxX=e.bbox.maxX,f.maxY=e.bbox.maxY}function c(n,t,r){var a=x;d.useProgram(a.program),o.a.bindAttribute(d,e.quadBuffer,a.a_pos,2),o.a.bindTexture(d,n,e.screenTextureUnit),d.uniform1i(a.u_screen,e.screenTextureUnit),d.uniform1f(a.u_opacity_border,.02),d.uniform1f(a.u_opacity,t),d.uniform3f(a.u_transform,r.dx,r.dy,r.scale),d.drawArrays(d.TRIANGLES,0,6)}var u,s,d=e.gl,l=e.canvasRect,v={dx:0,dy:0,scale:1},f=null,p={r:19/255,g:41/255,b:79/255,a:1};r();var x=o.a.createProgram(d,"// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}","precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  // For some reason particles near border leave trace when we translate the texture\n  // This is my dirty hack to fix it: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n  if (p.x < u_opacity_border || p.x > 1. - u_opacity_border || p.y < u_opacity_border || p.y > 1. - u_opacity_border) {\n    gl_FragColor = vec4(0.);\n  } else {\n    // opacity fade out even with a value close to 0.0\n    gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n  }\n}"),y={fadeOutLastFrame:n,renderCurrentScreen:t,updateScreenTextures:r,boundingBoxUpdated:!1};return y}n.a=r;var o=t("Ddjs"),a={dx:0,dy:0,scale:1}},i69e:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),l=t("Pf15"),v=t.n(l),f=t("4KA4"),p=function(e){function n(){return i()(this,n),d()(this,(n.__proto__||o()(n)).call(this))}return v()(n,e),u()(n,[{key:"getDefines",value:function(){return"\nuniform float u_h;\n"}},{key:"getFunctions",value:function(){return"\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}"}},{key:"getMainBody",value:function(){return"\n  vec2 velocity = rk4(pos);\n"}}]),n}(f.a);n.a=p},iw7m:function(e,n,t){"use strict";function r(e){if(!e)return a.a.reject("Missing link");var n=e.trim();if(!n)return a.a.reject("Missing link");var r=s.get(n);return r?a.a.resolve(r):t.i(u.a)(e).then(function(n){return s.set(e,n),n})}n.a=r;var o=t("//Fk"),a=t.n(o),i=t("ifoU"),c=t.n(i),u=t("C8nW"),s=new c.a},n67P:function(e,n,t){"use strict";function r(){function e(e,n){var t=o.get(e);t&&t.dispose(),o.set(e,n)}function n(e){r=e,o.forEach(t)}function t(e,n){e.updateBinding(r,n)}var r,o=new a.a;return{updateBindings:n,bindInput:e}}n.a=r;var o=t("ifoU"),a=t.n(o)},p0IO:function(e,n,t){"use strict";function r(e,n){var t=0,r=0,o=1;return{applyTransform:function(e){var a=e.x,i=e.y;0==o-e.scale&&Math.abs(a-t)<2.1&&Math.abs(i-r)<2.1||(t=a,r=i,o=e.scale,n(e))},getOwner:function(){return e}}}n.a=r},p2DF:function(e,n,t){"use strict";t("rvz5"),t("Ddjs")},p9aJ:function(e,n,t){"use strict";function r(e){function n(){window.removeEventListener("mousemove",o,!0),window.removeEventListener("mousedown",a,!0),window.removeEventListener("touchstart",t,!0),window.removeEventListener("touchmove",r,!0)}function t(e){var n=e.touches[0];n&&(c(n.clientX,n.clientY),i(n.clientX,n.clientY))}function r(e){var n=e.touches[0];n&&i(n.clientX,n.clientY)}function o(e){i(e.clientX,e.clientY)}function a(e){c(e.clientX,e.clientY)}function i(n,t){e.cursor.hoverX=u(n),e.cursor.hoverY=s(t)}function c(n,t){e.cursor.clickX=u(n),e.cursor.clickY=s(t)}function u(e){var n=(e-d.left)/d.width;return(l.maxX-l.minX)*n+l.minX}function s(e){var n=1-(e-d.top)/d.height;return(l.minY-l.maxY)*n+l.maxY}var d=e.canvasRect,l=e.bbox;return window.addEventListener("mousemove",o,!0),window.addEventListener("mousedown",a,!0),window.addEventListener("touchstart",t,!0),window.addEventListener("touchmove",r,!0),{dispose:n}}n.a=r},pKWO:function(e,n,t){"use strict";function r(e){function n(){g&&g.unload();var n=new a.a(e),t=n.getVertexShader(b);g=o.a.createProgram(h,t,n.getFragmentShader())}function r(){b&&(e.frame+=1,e.frameSeed=Math.random(),m&&m.updateTextures(),_.updateParticlesPositions())}function d(){n()}function l(t){e.frame=0,b=t,_.updateCode(t),n()}function v(){p=e.particleStateResolution,y=p*p;for(var n=new Float32Array(y),r=new Uint8Array(4*y),a=new Uint8Array(4*y),i=e.bbox.minX,u=e.bbox.minY,s=e.bbox.maxX-i,d=e.bbox.maxY-u,l=0;l<y;l++)t.i(c.a)(Math.random()*s+i,r,4*l),t.i(c.a)(Math.random()*d+u,a,4*l),n[l]=l;x&&h.deleteBuffer(x),x=o.a.createBuffer(h,n),_.updateParticlesCount(r,a)}function f(){if(b){var n=g;h.useProgram(n.program),o.a.bindAttribute(h,x,n.a_index,1),_.prepareToDraw(n),e.inputs.updateBindings(n),h.uniform1f(n.u_h,e.integrationTimeStep),h.uniform1f(n.frame,e.frame),h.uniform1f(n.u_particles_res,p);var t=e.bbox;h.uniform2f(n.u_min,t.minX,t.minY),h.uniform2f(n.u_max,t.maxX,t.maxY);var r=e.cursor;h.uniform4f(n.cursor,r.clickX,r.clickY,r.hoverX,r.hoverY),h.drawArrays(h.POINTS,0,y)}}var p,x,y,m,g,h=e.gl,b="",_=t.i(i.a)(e);return function(){n(),u.a.isAudioEnabled&&(m&&m.dispose(),m=t.i(s.a)(e))}(),{updateParticlesCount:v,updateParticlesPositions:r,drawParticles:f,updateCode:l,updateColorMode:d}}n.a=r;var o=t("Ddjs"),a=t("aZPT"),i=t("3xg8"),c=t("FaU1"),u=t("rvz5"),s=t("94y8")},pXNl:function(e,n,t){"use strict";function r(e,n,t){function r(n){c.forEach(function(t){e.uniform1i(n["u_particles_"+t.name],t.index)})}function a(){c.forEach(function(n){return e.deleteTexture(n.texture)})}function i(e,n){c.forEach(function(t){o.a.bindTexture(e,t.texture,t.index),e.uniform1i(n["u_particles_"+t.name],t.index)})}var c=n.map(function(n,r){return{texture:o.a.createTexture(e,e.NEAREST,n.particleState,t,t),index:r,name:n.name}});return{dispose:a,bindTextures:i,assignProgramUniforms:r,length:n.length,textures:c,get:function(e){return c[e]}}}n.a=r;var o=t("Ddjs")},rvz5:function(e,n,t){"use strict";var r=t("NEgR"),o={isAudioEnabled:!1,vectorLinesEnabled:!1,FREE_TEXTURE_UNIT:4,showBindings:r.a.getQS().get("showBindings")||!1};n.a=o},sbZs:function(e,n,t){"use strict";function r(e){_=e;var n=x.a.getQS();T=n.get("autosource"),["presets","generator","both"].includes(T)||(T&&console.error("unknown autosource param; options are presets, generator, or both"),T="both");var t=n.get("autotime");if(!t){if(!(t=n.get("auto")))return;console.warn("the auto param is deprecated; please use autotime")}var r=parseFloat(t);return p()(r)?void console.error("malformed autotime param; not a number"):(/ms$/i.test(t)||(/s$/i.test(t)?r*=1e3:/m$/i.test(t)?r*=6e4:/h$/i.test(t)&&(r*=36e5)),r<=500&&(console.warn("autotime param is too small; defaulting to 30 seconds"),r=3e4),h=r,a({immediately:!0}),o)}function o(){clearTimeout(w),w=0}function a(e){e=e||{};var n=T;if("both"===n&&(n=Math.random()<.5?"presets":"generator"),"generator"===n)_.setParticlesCount(1e4),_.vectorFieldEditorState.setCode(t.i(g.a)(t.i(m.a)()));else if("presets"===n){b&&b.length||(b=c(y.a));var r=b.shift();_.vectorFieldEditorState.setCode(r.code),u(r.colorMode)&&_.setColorMode(r.colorMode),u(r.timeStep)&&_.setIntegrationTimeStep(r.timeStep),u(r.fadeOut)&&_.setFadeOutSpeed(r.fadeOut),u(r.dropProbability)&&_.setDropProbability(r.dropProbability),u(r.particleCount)&&_.setParticlesCount(r.particleCount);var o=x.a.makeBBox(r.cx,r.cy,r.w,r.h);o&&(e.immediately?_.applyBoundingBox(o):i(o))}w=setTimeout(a,h)}function i(e){var n=v()({},_.getBoundingBox()),t=Date.now(),r=e.minX-n.minX,o=e.maxX-n.maxX,a=e.minY-n.minY,i=e.maxY-n.maxY;!function c(){var u=(Date.now()-t)/3e3;if(u>=1)return void _.applyBoundingBox(e);requestAnimationFrame(c);var s={minX:n.minX+r*u,maxX:n.maxX+o*u,minY:n.minY+a*u,maxY:n.maxY+i*u};_.applyBoundingBox(s)}()}function c(e){for(var n=e.slice(),t=0;t<n.length;t++){var r=Math.floor(Math.random()*n.length),o=n[t];n[t]=n[r],n[r]=o}return n}function u(e){return d()(e)}n.a=r;var s=t("AMV0"),d=t.n(s),l=t("woOf"),v=t.n(l),f=t("MICi"),p=t.n(f),x=t("NEgR"),y=t("7QEO"),m=t("7l3+"),g=t("cj2E"),h=void 0,b=void 0,_=void 0,w=void 0,T=void 0},svlg:function(e,n,t){"use strict";function r(e){if(!e)return new i.a(function(e){return e(s)});var n=o(e);return n.pending.length>0?i.a.all(n.pending).then(function(){return n}).catch(function(e){return{error:{error:e}}}):new i.a(function(e){return e(n)})}function o(e){function n(){return i.join("\n")}function r(e){if(0===e.indexOf(u)){var n=e.substr(u.length),r=s;o.push(t.i(c.a)(n).then(function(e){i[r]=e}))}}var o=[],a=e.split("\n"),i=[],s=0;return a.forEach(function(e,n){s=n,e&&"#"===e[0]?(i.push(""),r(e)):i.push(e)}),{getCode:n,pending:o}}n.a=r;var a=t("//Fk"),i=t.n(a),c=t("iw7m"),u="#include ",s={code:""}},vhRe:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),l=t("Pf15"),v=t.n(l),f=t("4KA4"),p=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.decode=e&&e.decode,t.srcPosName=e&&e.posName||"pos",t}return v()(n,e),u()(n,[{key:"getDefines",value:function(){if(this.decode)return"\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n"}},{key:"getMainBody",value:function(){return this.decode?"\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = "+this.srcPosName+".x * du.x + u_min.x;\n  pos.y = "+this.srcPosName+".y * du.y + u_min.y;\n":"\n  pos.x = ("+this.srcPosName+".x - u_min.x)/du.x;\n  pos.y = ("+this.srcPosName+".y - u_min.y)/du.y;\n"}}]),n}(f.a);n.a=p}},["YJWA"]);
//# sourceMappingURL=app.ee33bb1956d327992042.js.map